<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <title>分布式爬虫系统</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <!--external css-->
    <link href="assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
        
    <!-- Custom styles for this template -->
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="assets/css/style-responsive.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

  <section id="container" >
      <!-- **********************************************************************************************************************************************************
      TOP BAR CONTENT & NOTIFICATIONS
      *********************************************************************************************************************************************************** -->
      <!--header start-->
      <header class="header black-bg">
              <div class="sidebar-toggle-box">
                  <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
              </div>
            <!--logo start-->
            <a href="index.html" class="logo"><b>分 布 式 爬 虫 系 统</b></a>
            <!--logo end-->
            
            <div class="top-menu">
            	<ul class="nav pull-right top-menu">
                    <li><a class="logout" href="login.html">Logout</a></li>
            	</ul>
            </div>
        </header>
      <!--header end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN SIDEBAR MENU
      *********************************************************************************************************************************************************** -->
      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse ">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu" id="nav-accordion">
              
              	  <p class="centered"><a href="profile.html"><img src="assets/img/ui-sam.jpg" class="img-circle" width="60"></a></p>
              	  <h5 class="centered">Menu</h5>
              	  	
                  <li class="mt">
                      <a href="index.html">
                          <i class="fa fa-dashboard"></i>
                          <span>首页</span>
                      </a>
                  </li>

                  <li class="sub-menu">
                      <a  href="javascript:;" >
                          <i class="glyphicon glyphicon-leaf"></i>
                          <span>节点</span>
                      </a>
                      <ul class="sub">
                          <li ><a  href="addNode.html">添加节点</a></li>
                          <li><a  href="nodeState.html">节点状态</a></li>
                      </ul>
                  </li>

                  <li class="sub-menu">
                      <a class="active" href="javascript:;" >
                          <i class="fa fa-th"></i>
                          <span>任务</span>
                      </a>
                      <ul class="sub">
                          <li class="active"><a  href="addTask.html">添加任务</a></li>
                          <li><a  href="taskState.html">任务状态</a></li>
                      </ul>
                  </li>

              </ul>
              <!-- sidebar menu end-->
          </div>
      </aside>
      <!--sidebar end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN CONTENT
      *********************************************************************************************************************************************************** -->
      <!--main content start-->
      <div class="well">
      <section id="main-content">
          <section class="wrapper">
          	<h3><i class="fa fa-angle-right"></i>添加任务</h3>
        <div class="row mt">
              <div class="col-lg-12">
                  <div class="form-panel" style="width:95%;margin:0 auto">
                      <form style="width:90%;margin:0 auto" class="form-horizontal style-form" method="get">


            <input type='button' class='btnAdd' value='添加' hidden="hidden"/>
            <div id="father">
                <form method="post" action="{{ url_for('addtask') }}" name="conform" class="confirm">
                    <fieldset>
                        <!--<legend>任务</legend>-->
                        <div class="form-group">
                              <label class="col-sm-2 col-sm-2 control-label">任务入口url</label>
                              <div class="col-sm-10">
                                  <input type="text" class="form-control round-form start_url" name="start_url">
                              </div>
                          </div></br>
                        <div class="form-group">
                              <label class="col-sm-2 col-sm-2 control-label">任务优先级</label>
                              <div class="col-sm-10">
                                  <input type="text" class="form-control round-form priority" name="priority">
                              </div>
                        </div>
</br>
                        <div class="form-group">
                          <div class="col-sm-2 col-sm-2 control-label" style="float:left">任 务 类 型</div>
                            <div class="col-sm-10">
                              <select class="form-control testName" name="type">
                                <option value="1" autofocus="true">电商类</option>
                                <option value="0">新闻博客类</option>
                              </select>
                            </div>
                        </div>
</br>
                        <div class="form-group">
                              <label class="col-sm-2 col-sm-2 control-label">允许爬取域名</label>
                              <div class="col-sm-10">
                                  <input type="text" class="form-control round-form testName" name="alloweddomains">
                              </div>
                        </div>
                        </br>


                        <!--<input type="text" placeholder="type"  name="type" class="testName" hidden="hidden"/>-->

                        <div>
                      <div style="margin:0 auto; width:600px; height:70px;"><!-- /保持按钮居中 -->
                        <div class="btn-group btn-group-justified">
                          <div class="btn-group">
                            <button type="button" class="btn btn-theme03" id="btn_addrules">添加一个规则</button>
                          </div>
                          <div class="btn-group">
                            <button type="button" class="btn btn-theme05" id="btn_deleterules">删除一个规则</button>
                          </div>
                        </div>
                      </div>
                          
                          
                            
                            <br>
                            <div class="app1" name="app1">
                            </div>
                        </div>
                        <br>
                        <input type='button' class='btnDel' value='delete the task' onclick = "$(this).parent().remove();" hidden="hidden"/>
                    </fieldset>
                    <br>
                    <div style="margin:0 auto; width:600px; height:70px;">
                      <button type="submit" class="btn btnSub btn-primary btn-lg btn-block" id="btn_sub">提交</button>
                    </div>
                </form>
            </div>

</from>
</div>
</div>
</div>
		      </section><! --/wrapper -->
      </section><!-- /MAIN CONTENT -->
</div>
      <!--main content end-->
      <!--footer start-->
      <footer class="site-footer">
      </footer>
      <!--footer end-->
  </section>

    <!-- js placed at the end of the document so the pages load faster -->
    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script class="include" type="text/javascript" src="assets/js/jquery.dcjqaccordion.2.7.js"></script>
    <script src="assets/js/jquery.scrollTo.min.js"></script>
    <script src="assets/js/jquery.nicescroll.js" type="text/javascript"></script>


    <!--common script for all pages-->
    <script src="assets/js/common-scripts.js"></script>

    <!--script for this page-->
    
<script type="text/javascript">
//        $(document).ready(function () {
//            $('#btn_sub').click(function () {
//                alert("任务添加成功！！！");
//                window.location.href = "test.html";
//            })
//        })
        var blockNum=10;
        $(document).ready(function(){
            var parentDom=$('#father').find("form"),oriDom=parentDom.children(":first");
            $('.btnAdd').click(function(){
                var clLength=parentDom.children().length;
                if(blockNum>clLength){
                    var nowDom=oriDom.clone();
                    nowDom.children(":first").text('任务');
                    parentDom.append(nowDom);
                }
                else
                    return false;
            });
            $('.btnSub').click(function(){
               $('.conform').submit();
            });
        });

        //定义rulenum表示第几个rule,定义itemnum[i][j]表示第i个rule的第j个itemcontent
        var rulenum = 1;
        var itemnum = new Array();
        for(var i = 0;i < 10;i++)
        {
            itemnum[i] = 1;
        }

      $(document).ready(function(){
        $("#btn_addrules").click(function(){
            var html1 = ' <div style="width:90%;margin:0 auto" class="well" id='+rulenum+'>'
                        +'<input type="text" class="form-control round-form" placeholder="re_url" name="re_url'+'.'+rulenum+'"/><br>'
//                        +'<input type="text" placeholder="rule_type" name="rule_type'+'.'+rulenum+'"/><br>'
                        +'<select name="rule_type'+'.'+rulenum+'" class="form-control testName"><option value="0" autofocus="true">XPATH匹配</option><option value="1">元素CLASS NAME匹配</option><option value="2">CSSSELECTOR匹配</option><option value="3">元素ID匹配</option><option value="5">元素NAME匹配</option><option value="6">元素TAG_NAME匹配</option></select><br>'
//                        +'<input type="text" placeholder="comment_button_type" name="comment_button_type'+'.'+rulenum+'"/>'
//                        +'<input type="text" placeholder="comment_button_content" name="comment_button_content'+'.'+rulenum+'"/>'
//                        +'<input type="text" placeholder="next_page_type" name="next_page_type'+'.'+rulenum+'" />'
//                        +'<input type="text" placeholder="next_page_content" name="next_page_content'+'.'+rulenum+'" /><br>'

            +'<div class="col-sm-3"></div>'+ '<input  type="button" value="add itemcontents" class="col-sm-3 add_itemcontents btn btn-info btn-sm" id="'+rulenum+'">'
                        +'<input type="button" value="delete" class="col-sm-3 btn_deleteitem btn btn-deflaut btn-sm" id="'+rulenum+'"><br><br>'  

                        +'<div id="items'+rulenum+'" class="app2">'+'</div>'
                    +'</div><br><br><br>';
          $(".app1").append(html1);

                $(".add_itemcontents").click(function(){
                    var str1 = $(this).parents("div").attr("id");
                    var str5 = ".well"+str1;
                    var str2 = $(str5).size() + 1;
                    alert(str2);

                    var str3 = str1+"."+str2;
                    alert(str3);
                    var str4 = "#items"+str1;
                    var html2='<br><div style="margin:0 auto; width:85%; height:35px;" class="form-inline well'+str1+'"id ="'+str3+'"><input style="width:50%" class="form-control round-form" type="text" placeholder="key" name="key'+'.'+str3+'"/>' +
//                        '<input type="text" placeholder="content_type" name="content_type'+'.'+str3+'"/>' +
                        '<input  style="width:40%" class="form-control round-form" type="text" placeholder="content_content" name="content_content'+'.'+str3+'"/>'
                        + '<input style="width:10%" class="btn btn-warning btn-sm btn-round" type="button" id="delete" value="delete" onclick="del()">'
                        +'</div>';
                    $(this).parents("div").find(str4).append(html2);

                    $("#delete").click(function () {
                        $(this).parent().remove();
                    });

                });

                $(".btn_deleteitem").click(function(){

                    var str1 = $(this).attr("id");
                    var str5 = ".well"+str1+":last";

                    var str2 = $(str5).size();
                    var str4 = "#"+str1+"."+str2;

                    alert($(".well1").size());
                    $(str5).remove();
                    $(str4).remove();

                });

                rulenum = rulenum + 1;
        });



        $("#btn_deleterules").click(function(){
            if(rulenum >= 1)
                {
                    var str1 = "#"+(rulenum-1);
                    $(str1).remove();
              rulenum = rulenum - 1;
                }
        });
      });
    </script>

  </body>
</html>
